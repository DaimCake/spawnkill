Fonctionnement du serveur de socket

un topic a :
	- un id
	- une liste d'inscrits
	- un nombre de pages courant
	- un nombre de posts courants
	- une méthode permettant de récupérer les infos du topic
	- une méthode permettant d'obtenir une url d'une page du topic à partir de la page
	- une méthode pour prévenir tous les utilisateurs courants

un message (json) a :
	- un identifiant
	- des données

le serveur a :
	- une liste de connectés
	- une liste de topics suivis
	- un objet permettant de faire des requêtes HTTP en parallèle

	on (connexion ouverte) :
		ajout de la connexion à la liste de connectés

	on (message) :
		si (message.identifiant = premier message)
			si (message.topicId n'existe pas dans liste des topics)
				ajout du topic à la liste des topics
			ajout de l'utilisateur au topic concerné
			si (nombre de posts du topic renseigné)
				envoi direct d'un message à l'utilisateur avec les infos du topic

	on (connexion fermée) :
		parcourt de la liste des topics du connecté
			suppression du connecté du topic

			si (plus de connectés sur le topic)
				suppression du topic de la liste


	boucle en tâche de fond :
		parcourt de la liste des topics suivis
			on ajoute la requête de la dernière page connue aux infos à récupérer

		on récupère toutes les données de la liste d'urls

		parcourt des données récupérées
			On calcule le nombre de page du topic
			Si (on vient de récupérer le dernière page)
				On calcule le nombre de posts du topic
				On met à jour le nombre de posts du topic
				On construit le résultat
				On parcourt la liste d'utilisateurs du topic
					On envoie à tous ces utilisateurs la mise à jour des infos

				Sinon (pas sur la dernière page)
					On met à jour le nombre de pages du topic
					On ajoute la requête des récupération de la dernière page aux urls à récupérer
		
		on récupère toutes les données de la liste d'urls

		parcourt des données récupérées
			On calcule le nombre de posts du topic
			On met à jour le nombre de posts du topic
			On construit le résultat
			On parcourt la liste d'utilisateurs du topic
				On envoie à tous ces utilisateurs la mise à jour des infos

			attente 2 secondes


TODO :
- Gestion des 404/topic supprimés/Problème de réseau/timeout
- Gestion des connexions fermées à l'envoi
- Gérer le cas où le client n'a pas encore envoyé de premire message